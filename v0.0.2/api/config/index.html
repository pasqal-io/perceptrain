
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pasqal-io.github.io/perceptrain/v0.0.2/api/config/">
      
      
        <link rel="prev" href="../trainer/">
      
      
        <link rel="next" href="../accelerator/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.10">
    
    
      
        <title>Configurations - Perceptrain</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extras/css/colors.css">
    
      <link rel="stylesheet" href="../../extras/css/home.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-and-configurations" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Perceptrain" class="md-header__button md-logo" aria-label="Perceptrain" data-md-component="logo">
      
  <img src="../../extras/assets/logo/perceptrain_logo_small_white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Perceptrain
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configurations
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pasqal-io/perceptrain/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    perceptrain
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting_started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorials/" class="md-tabs__link">
        
  
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../trainer/" class="md-tabs__link">
          
  
  
    
  
  API

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://github.com/pasqal-io/perceptrain/discussions" class="md-tabs__link">
        
  
  
    
  
  Contact

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Perceptrain" class="md-nav__button md-logo" aria-label="Perceptrain" data-md-component="logo">
      
  <img src="../../extras/assets/logo/perceptrain_logo_small_white.svg" alt="logo">

    </a>
    Perceptrain
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pasqal-io/perceptrain/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    perceptrain
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development & Info
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Development & Info
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_started/LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/training/loss/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Loss Functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/training/tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/training/gradient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Optimization Type
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/training/hooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Stages Hooks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/training/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exmaples
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Data & Configuration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Data & Configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dataconfig/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TrainConfig
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dataconfig/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dataloader
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/dataconfig/tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Experiment Tracking
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Callbacks
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Callbacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/callbacks/default/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    List of Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/callbacks/trainer_callbacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Callbacks with Trainer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/callbacks/custom/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Distributed Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Distributed Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/accelerator_doc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accelerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_2" >
        
          
          <label class="md-nav__link" for="__nav_3_4_2" id="__nav_3_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    CPU Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_2">
            <span class="md-nav__icon md-icon"></span>
            CPU Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/single_cpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single Process
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/multi_cpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Process
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4_3" >
        
          
          <label class="md-nav__link" for="__nav_3_4_3" id="__nav_3_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    GPU Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4_3">
            <span class="md-nav__icon md-icon"></span>
            GPU Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/single_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Single GPU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/multi_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi GPU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/distributed/multinode_gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Node
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../trainer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Trainer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Configurations
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Configurations
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-and-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Data and configurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data and configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.all_reduce_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.compute_setup" class="md-nav__link">
    <span class="md-ellipsis">
      compute_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_setup" class="md-nav__link">
    <span class="md-ellipsis">
      log_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.nprocs" class="md-nav__link">
    <span class="md-ellipsis">
      nprocs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.rank" class="md-nav__link">
    <span class="md-ellipsis">
      rank
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QuantumModel" class="md-nav__link">
    <span class="md-ellipsis">
      QuantumModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QuantumModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QuantumModel.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accelerator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Accelerator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../callback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Callbacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../information/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Information Content
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/pasqal-io/perceptrain/discussions" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contact
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-and-configurations" class="md-nav__link">
    <span class="md-ellipsis">
      Data and configurations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data and configurations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig" class="md-nav__link">
    <span class="md-ellipsis">
      TrainConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TrainConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.all_reduce_metrics" class="md-nav__link">
    <span class="md-ellipsis">
      all_reduce_metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.batch_size" class="md-nav__link">
    <span class="md-ellipsis">
      batch_size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.callbacks" class="md-nav__link">
    <span class="md-ellipsis">
      callbacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.checkpoint_best_only" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_best_only
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.checkpoint_every" class="md-nav__link">
    <span class="md-ellipsis">
      checkpoint_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.compute_setup" class="md-nav__link">
    <span class="md-ellipsis">
      compute_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.create_subfolder_per_run" class="md-nav__link">
    <span class="md-ellipsis">
      create_subfolder_per_run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.hyperparams" class="md-nav__link">
    <span class="md-ellipsis">
      hyperparams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_folder" class="md-nav__link">
    <span class="md-ellipsis">
      log_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_model" class="md-nav__link">
    <span class="md-ellipsis">
      log_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.log_setup" class="md-nav__link">
    <span class="md-ellipsis">
      log_setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.max_iter" class="md-nav__link">
    <span class="md-ellipsis">
      max_iter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.nprocs" class="md-nav__link">
    <span class="md-ellipsis">
      nprocs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.plot_every" class="md-nav__link">
    <span class="md-ellipsis">
      plot_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.plotting_functions" class="md-nav__link">
    <span class="md-ellipsis">
      plotting_functions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.print_every" class="md-nav__link">
    <span class="md-ellipsis">
      print_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.root_folder" class="md-nav__link">
    <span class="md-ellipsis">
      root_folder
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.tracking_tool" class="md-nav__link">
    <span class="md-ellipsis">
      tracking_tool
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.trainstop_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      trainstop_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.val_epsilon" class="md-nav__link">
    <span class="md-ellipsis">
      val_epsilon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.val_every" class="md-nav__link">
    <span class="md-ellipsis">
      val_every
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.validation_criterion" class="md-nav__link">
    <span class="md-ellipsis">
      validation_criterion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.verbose" class="md-nav__link">
    <span class="md-ellipsis">
      verbose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.config.TrainConfig.write_every" class="md-nav__link">
    <span class="md-ellipsis">
      write_every
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.get_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      get_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.num_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      num_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.parameters.set_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      set_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.DictDataLoader" class="md-nav__link">
    <span class="md-ellipsis">
      DictDataLoader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.InfiniteTensorDataset" class="md-nav__link">
    <span class="md-ellipsis">
      InfiniteTensorDataset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult" class="md-nav__link">
    <span class="md-ellipsis">
      OptimizeResult
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OptimizeResult">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.device" class="md-nav__link">
    <span class="md-ellipsis">
      device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.extra" class="md-nav__link">
    <span class="md-ellipsis">
      extra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.iteration" class="md-nav__link">
    <span class="md-ellipsis">
      iteration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.loss" class="md-nav__link">
    <span class="md-ellipsis">
      loss
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.optimizer" class="md-nav__link">
    <span class="md-ellipsis">
      optimizer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.OptimizeResult.rank" class="md-nav__link">
    <span class="md-ellipsis">
      rank
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.data_to_device" class="md-nav__link">
    <span class="md-ellipsis">
      data_to_device
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.data.to_dataloader" class="md-nav__link">
    <span class="md-ellipsis">
      to_dataloader
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QNN" class="md-nav__link">
    <span class="md-ellipsis">
      QNN
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QNN">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QNN.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QuantumModel" class="md-nav__link">
    <span class="md-ellipsis">
      QuantumModel
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QuantumModel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#perceptrain.models.QuantumModel.forward" class="md-nav__link">
    <span class="md-ellipsis">
      forward
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Configurations</h1>

<h2 id="data-and-configurations">Data and configurations</h2>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="perceptrain.config.TrainConfig" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">TrainConfig</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">print_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">write_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">checkpoint_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">plot_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">()(),</span> <span class="n">log_model</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">root_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">),</span> <span class="n">create_subfolder_per_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">log_folder</span><span class="o">=</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">),</span> <span class="n">checkpoint_best_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">val_every</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_epsilon</span><span class="o">=</span><span class="mf">1e-05</span><span class="p">,</span> <span class="n">validation_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">trainstop_criterion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tracking_tool</span><span class="o">=</span><span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span><span class="p">,</span> <span class="n">hyperparams</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">plotting_functions</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(),</span> <span class="n">_subfolders</span><span class="o">=</span><span class="nb">list</span><span class="p">(),</span> <span class="n">nprocs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">compute_setup</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="s1">&#39;gloo&#39;</span><span class="p">,</span> <span class="n">log_setup</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">all_reduce_metrics</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Default configuration for the training process.</p>
<p>This class provides default settings for various aspects of the training loop,
such as logging, checkpointing, and validation. The default values for these
fields can be customized when an instance of <code>TrainConfig</code> is created.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">perceptrain</span><span class="w"> </span><span class="kn">import</span> <span class="n">TrainConfig</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">c</span> <span class="o">=</span> <span class="n">TrainConfig</span><span class="p">(</span><span class="n">root_folder</span><span class="o">=</span><span class="s2">&quot;/tmp/train&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="result" markdown="1" >

<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">Trai</span><span class="kc">n</span><span class="err">Co</span><span class="kc">nf</span><span class="err">ig(max_i</span><span class="kc">ter</span><span class="err">=</span><span class="mi">10000</span><span class="p">,</span><span class="w"> </span><span class="err">pri</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">wri</span><span class="kc">te</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">plo</span><span class="kc">t</span><span class="err">_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">callbacks=</span><span class="p">[],</span><span class="w"> </span><span class="err">log_model=False</span><span class="p">,</span><span class="w"> </span><span class="err">roo</span><span class="kc">t</span><span class="err">_</span><span class="kc">f</span><span class="err">older=&#39;/</span><span class="kc">t</span><span class="err">mp/</span><span class="kc">tra</span><span class="err">i</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">crea</span><span class="kc">te</span><span class="err">_sub</span><span class="kc">f</span><span class="err">older_per_ru</span><span class="kc">n</span><span class="err">=False</span><span class="p">,</span><span class="w"> </span><span class="err">log_</span><span class="kc">f</span><span class="err">older=PosixPa</span><span class="kc">t</span><span class="err">h(&#39;.&#39;)</span><span class="p">,</span><span class="w"> </span><span class="err">checkpoi</span><span class="kc">nt</span><span class="err">_bes</span><span class="kc">t</span><span class="err">_o</span><span class="kc">nl</span><span class="err">y=False</span><span class="p">,</span><span class="w"> </span><span class="err">val_every=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">val_epsilo</span><span class="kc">n</span><span class="err">=</span><span class="mf">1e-05</span><span class="p">,</span><span class="w"> </span><span class="err">valida</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">i</span><span class="kc">nst</span><span class="err">op_cri</span><span class="kc">ter</span><span class="err">io</span><span class="kc">n</span><span class="err">=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">ba</span><span class="kc">t</span><span class="err">ch_size=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">verbose=True</span><span class="p">,</span><span class="w"> </span><span class="kc">tra</span><span class="err">cki</span><span class="kc">n</span><span class="err">g_</span><span class="kc">t</span><span class="err">ool=&lt;Experime</span><span class="kc">nt</span><span class="err">Tracki</span><span class="kc">n</span><span class="err">gTool.TENSORBOARD</span><span class="p">:</span><span class="w"> </span><span class="err">&#39;</span><span class="kc">tens</span><span class="err">orboard&#39;&gt;</span><span class="p">,</span><span class="w"> </span><span class="err">hyperparams=</span><span class="p">{},</span><span class="w"> </span><span class="err">plo</span><span class="kc">tt</span><span class="err">i</span><span class="kc">n</span><span class="err">g_</span><span class="kc">fun</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">ns</span><span class="err">=()</span><span class="p">,</span><span class="w"> </span><span class="err">_sub</span><span class="kc">f</span><span class="err">olders=</span><span class="p">[],</span><span class="w"> </span><span class="kc">n</span><span class="err">procs=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">compu</span><span class="kc">te</span><span class="err">_se</span><span class="kc">tu</span><span class="err">p=&#39;cpu&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">backe</span><span class="kc">n</span><span class="err">d=&#39;gloo&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">log_se</span><span class="kc">tu</span><span class="err">p=&#39;cpu&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">d</span><span class="kc">t</span><span class="err">ype=No</span><span class="kc">ne</span><span class="p">,</span><span class="w"> </span><span class="err">all_reduce_me</span><span class="kc">tr</span><span class="err">ics=False)</span>
</code></pre></div>

</div></p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.all_reduce_metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">all_reduce_metrics</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to aggregate metrics (e.g., loss, accuracy) across processes.</p>
<p>When True, metrics from different training processes are averaged to provide a consolidated metrics.
Note: Since aggregation requires synchronization/all_reduce operation, this can increase the
 computation time significantly.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.backend" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">backend</span> <span class="o">=</span> <span class="s1">&#39;gloo&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Backend used for distributed training communication.</p>
<p>The default is "gloo". Other options may include "nccl" - which is optimized for GPU-based training or "mpi",
depending on your system and requirements.
It should be one of the backends supported by <code>torch.distributed</code>. For further details, please look at
<a href="https://pytorch.org/docs/stable/distributed.html#torch.distributed.Backend">torch backends</a></p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.batch_size" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The batch size to use when processing a list or tuple of torch.Tensors.</p>
<p>This specifies how many samples are processed in each training iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.callbacks" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">callbacks</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">list</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>List of callbacks to execute during training.</p>
<p>Callbacks can be used for
custom behaviors, such as early stopping, custom logging, or other actions
triggered at specific events.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.checkpoint_best_only" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_best_only</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>If <code>True</code>, checkpoints are only saved if there is an improvement in the.</p>
<p>validation metric. This conserves storage by only keeping the best models.</p>
<p>validation_criterion is required when this is set to True.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.checkpoint_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">checkpoint_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for saving model and optimizer checkpoints during training.</p>
<p>Set to 0 to disable checkpointing. This helps in resuming training or recovering
models.
Note that setting checkpoint_best_only = True will disable this and only best checkpoints will
be saved.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.compute_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute_setup</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute device setup; options are "auto", "gpu", or "cpu".</p>
<ul>
<li>"auto": Automatically uses GPU if available; otherwise, falls back to CPU.</li>
<li>"gpu": Forces GPU usage, raising an error if no CUDA device is available.</li>
<li>"cpu": Forces the use of CPU regardless of GPU availability.</li>
</ul>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.create_subfolder_per_run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_subfolder_per_run</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to create a subfolder for each run, named <code>&lt;id&gt;_&lt;timestamp&gt;_&lt;PID&gt;</code>.</p>
<p>This ensures logs and checkpoints from different runs do not overwrite each other,
which is helpful for rapid prototyping. If <code>False</code>, training will resume from
the latest checkpoint if one exists in the specified log folder.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.dtype" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Data type (precision) for computations.</p>
<p>Both model parameters, and dataset will be of the provided precision.</p>
<p>If not specified or None, the default torch precision (usually torch.float32) is used.
If provided dtype is torch.complex128, model parameters will be torch.complex128, and data parameters will be torch.float64</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.hyperparams" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hyperparams</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A dictionary of hyperparameters to be tracked.</p>
<p>This can include learning rates,
regularization parameters, or any other training-related configurations.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.log_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The log folder for saving checkpoints and tensorboard logs.</p>
<p>This stores the path where all logs and checkpoints are being saved
for this training session. <code>log_folder</code> takes precedence over <code>root_folder</code>,
but it is ignored if <code>create_subfolders_per_run=True</code> (in which case, subfolders
will be spawned in the root folder).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.log_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_model</span> <span class="o">=</span> <span class="kc">False</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to log a serialized version of the model.</p>
<p>When set to <code>True</code>, the
model's state will be logged, useful for model versioning and reproducibility.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.log_setup" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_setup</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Logging device setup; options are "auto" or "cpu".</p>
<ul>
<li>"auto": Uses the same device for logging as for computation.</li>
<li>"cpu": Forces logging to occur on the CPU. This can be useful to avoid potential conflicts with GPU processes.</li>
</ul>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.max_iter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">10000</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Number of training iterations (epochs) to perform.</p>
<p>This defines the total number
of times the model will be updated.</p>
<p>In case of InfiniteTensorDataset, each epoch will have 1 batch.
In case of TensorDataset, each epoch will have len(dataloader) batches.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.nprocs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nprocs</span> <span class="o">=</span> <span class="mi">1</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The number of processes to use for training when spawning subprocesses.</p>
<p>For effective parallel processing, set this to a value greater than 1.
- In case of Multi-GPU or Multi-Node-Multi-GPU setups, nprocs should be equal to
the total number of GPUs across all nodes (world size), or total number of GPU to be used.</p>
<p>If nprocs &gt; 1, multiple processes will be spawned for training. The training framework will launch
additional processes (e.g., for distributed or parallel training).
- For CPU setup, this will launch a true parallel processes
- For GPU setup, this will launch a distributed training routine.
This uses the DistributedDataParallel framework from PyTorch.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.plot_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for generating and saving figures during training.</p>
<p>Set to 0 to disable plotting.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.plotting_functions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plotting_functions</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Functions used for in-training plotting.</p>
<p>These are called to generate
plots that are logged or saved at specified intervals.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.print_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for printing loss and metrics to the console during training.</p>
<p>Set to 0 to disable this output, meaning that metrics and loss will not be printed
during training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.root_folder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">root_folder</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;./qml_logs&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The root folder for saving checkpoints and tensorboard logs.</p>
<p>The default path is "./qml_logs"</p>
<p>This can be set to a specific directory where training artifacts are to be stored.
Checkpoints will be saved inside a subfolder in this directory. Subfolders will be
created based on <code>create_subfolder_per_run</code> argument.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.tracking_tool" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">tracking_tool</span> <span class="o">=</span> <span class="n">ExperimentTrackingTool</span><span class="o">.</span><span class="n">TENSORBOARD</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>The tool used for tracking training progress and logging metrics.</p>
<p>Options include tools like TensorBoard, which help visualize and monitor
model training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.trainstop_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trainstop_criterion</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A function to determine if the training process should stop based on a.</p>
<p>specific stopping metric. If <code>None</code>, training continues until <code>max_iter</code> is reached.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.val_epsilon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_epsilon</span> <span class="o">=</span> <span class="mf">1e-05</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A small safety margin used to compare the current validation loss with the.</p>
<p>best previous validation loss. This is used to determine improvements in metrics.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.val_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">val_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for performing validation.</p>
<p>If set to 0, validation is not performed.
Note that metrics from validation are always written, regardless of the <code>write_every</code> setting.
Note that initial validation happens at the start of training (when val_every &gt; 0)
    For initial validation  - initial metrics are written.
                            - checkpoint is saved (when checkpoint_best_only = False)</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.validation_criterion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validation_criterion</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>A function to evaluate whether a given validation metric meets a desired condition.</p>
<p>The validation_criterion has the following format:
def validation_criterion(val_loss: float, best_val_loss: float, val_epsilon: float) -&gt; bool:
    # process</p>
<p>If <code>None</code>, no custom validation criterion is applied.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.verbose" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Whether to print metrics and status messages during training.</p>
<p>If <code>True</code>, detailed metrics and status updates will be displayed in the console.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.config.TrainConfig.write_every" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">write_every</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Frequency (in epochs) for writing loss and metrics using the tracking tool during training.</p>
<p>Set to 0 to disable this logging, which prevents metrics from being logged to the tracking tool.
Note that the metrics will always be written at the end of training regardless of this setting.</p>

    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="perceptrain.parameters.get_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieve all trainable model parameters in a single vector.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>Tensor</code>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>a 1-dimensional tensor with the parameters</p>
              </div>
                <p>
                  <span class="doc-returns-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
                </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>perceptrain/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve all trainable model parameters in a single vector.</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="sd">        Tensor: a 1-dimensional tensor with the parameters</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">ps</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">]</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="perceptrain.parameters.num_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Return the total number of parameters of the given model.</p>


            <details class="quote">
              <summary>Source code in <code>perceptrain/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">def</span><span class="w"> </span><span class="nf">num_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the total number of parameters of the given model.&quot;&quot;&quot;</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="perceptrain.parameters.set_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set all trainable parameters of a model from a single vector.</p>
<p>Notice that this function assumes prior knowledge of right number
of parameters in the model</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the input PyTorch model</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>theta</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>the parameters to assign</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>perceptrain/parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="k">def</span><span class="w"> </span><span class="nf">set_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Set all trainable parameters of a model from a single vector.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Notice that this function assumes prior knowledge of right number</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    of parameters in the model</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): the input PyTorch model</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        theta (Tensor): the parameters to assign</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="k">for</span> <span class="n">ps</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">():</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>            <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">:</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>                <span class="n">n</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">numel</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>                <span class="k">if</span> <span class="n">ps</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>                    <span class="n">ps</span><span class="p">[()]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>                <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>                    <span class="n">ps</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">idx</span> <span class="p">:</span> <span class="n">idx</span> <span class="o">+</span> <span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">ps</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>                <span class="n">idx</span> <span class="o">+=</span> <span class="n">n</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-function">




    <div class="doc doc-contents first">

        <p>Default Torch optimize step with closure.</p>
<p>This is the default optimization step.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input model to be optimized.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.nn.Module">Module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimizer</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The chosen Torch optimizer.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.optim.Optimizer">Optimizer</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>loss_fn</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A custom loss function
that returns the loss value and a dictionary of metrics.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="typing.Callable">Callable</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input data. If None, it means
the given model does not require any input data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span> | <span title="list">list</span> | <span title="perceptrain.models.Tensor">Tensor</span> | None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>A target device to run computations on.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.device">device</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for <code>xs</code> conversion.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.dtype">dtype</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span>[<span title="torch.Tensor">Tensor</span> | <span title="float">float</span>, <span title="dict">dict</span> | None]</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>tuple[Tensor | float, dict | None]: A tuple containing the computed loss value
and a dictionary with collected metrics.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>perceptrain/optimize_step.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="k">def</span><span class="w"> </span><span class="nf">optimize_step</span><span class="p">(</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>    <span class="n">model</span><span class="p">:</span> <span class="n">Module</span><span class="p">,</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>    <span class="n">optimizer</span><span class="p">:</span> <span class="n">Optimizer</span><span class="p">,</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="n">loss_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a>    <span class="n">xs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a>    <span class="n">device</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>    <span class="n">dtype</span><span class="p">:</span> <span class="n">torch</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Default Torch optimize step with closure.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    This is the default optimization step.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        model (Module): The input model to be optimized.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        optimizer (Optimizer): The chosen Torch optimizer.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">        loss_fn (Callable): A custom loss function</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">            that returns the loss value and a dictionary of metrics.</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        xs (dict | list | Tensor | None): The input data. If None, it means</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">            the given model does not require any input data.</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a><span class="sd">        device (torch.device): A target device to run computations on.</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a><span class="sd">        dtype (torch.dtype): Data type for `xs` conversion.</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="sd">        tuple[Tensor | float, dict | None]: A tuple containing the computed loss value</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="sd">            and a dictionary with collected metrics.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{}</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">closure</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>        <span class="c1"># NOTE: We need the nonlocal as we can&#39;t return a metric dict and</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="c1"># because e.g. LBFGS calls this closure multiple times but for some</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="c1"># reason the returned loss is always the first one...</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="k">nonlocal</span> <span class="n">metrics</span><span class="p">,</span> <span class="n">loss</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xs</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">(</span><span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>        <span class="k">return</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">closure</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="c1"># return the loss/metrics that are being mutated inside the closure...</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">metrics</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="perceptrain.data.DictDataLoader" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">DictDataLoader</span><span class="p">(</span><span class="n">dataloaders</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>This class only holds a dictionary of <code>DataLoader</code>s and samples from them.</p>










  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="perceptrain.data.InfiniteTensorDataset" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.utils.data.IterableDataset">IterableDataset</span></code></p>


        <p>Randomly sample points from the first dimension of the given tensors.</p>
<p>Behaves like a normal torch <code>Dataset</code> just that we can sample from it as
many times as we want.</p>
<p>Examples:
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">perceptrain.data</span><span class="w"> </span><span class="kn">import</span> <span class="n">InfiniteTensorDataset</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="c1"># The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="c1"># call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">xs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ds</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">(</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.6152</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2244</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">1.</span><span class="p">]</span><span class="err">))</span>
</code></pre></div></p>







                  <details class="quote">
                    <summary>Source code in <code>perceptrain/data.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Randomly sample points from the first dimension of the given tensors.</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">    Behaves like a normal torch `Dataset` just that we can sample from it as</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">    many times as we want.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">    from perceptrain.data import InfiniteTensorDataset</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">    x_data, y_data = torch.rand(5,2), torch.ones(5,1)</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    # The dataset accepts any number of tensors with the same batch dimension</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    ds = InfiniteTensorDataset(x_data, y_data)</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    # call `next` to get one sample from each tensor:</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="sd">    xs = next(iter(ds))</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a><span class="sd">    print(str(xs)) # markdown-exec: hide</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a><span class="sd">    ```</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">tensors</span> <span class="o">=</span> <span class="n">tensors</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="perceptrain.data.OptimizeResult" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">OptimizeResult</span><span class="p">(</span><span class="n">iteration</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()(),</span> <span class="n">extra</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">()(),</span> <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>OptimizeResult stores many optimization intermediate values.</p>
<p>We store at a current iteration,
the model, optimizer, loss values, metrics. An extra dict
can be used for saving other information to be used for callbacks.</p>










  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">device</span> <span class="o">=</span> <span class="s1">&#39;cpu&#39;</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Device on which this result for calculated.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.extra" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">extra</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Extra dict for saving anything else to be used in callbacks.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.iteration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">iteration</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Current iteration number.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.loss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Loss value.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.metrics" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">metrics</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="nb">dict</span><span class="p">())</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Metrics that can be saved during training.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Model at iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.optimizer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimizer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Optimizer at iteration.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="perceptrain.data.OptimizeResult.rank" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rank</span> <span class="o">=</span> <span class="mi">0</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Rank of the process for which this result was generated.</p>

    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="perceptrain.data.data_to_device" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Utility method to move arbitrary data to 'device'.</p>


            <details class="quote">
              <summary>Source code in <code>perceptrain/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="nd">@singledispatch</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="k">def</span><span class="w"> </span><span class="nf">data_to_device</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility method to move arbitrary data to &#39;device&#39;.&quot;&quot;&quot;</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unable to move </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span><span class="si">}</span><span class="s2"> with input args: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2"> and kwargs: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="perceptrain.data.to_dataloader" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert torch tensors an (infinite) Dataloader.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>*tensors</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Torch tensors to use in the dataloader.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="torch.Tensor">Tensor</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>()</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>batch size of sampled tensors</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>1</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>infinite</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>if <code>True</code>, the dataloader will keep sampling indefinitely even after the whole
dataset was sampled once</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Examples:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">perceptrain</span><span class="w"> </span><span class="kn">import</span> <span class="n">to_dataloader</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">loader</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">to_dataloader</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">infinite</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">loader</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.0431</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5744</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3787</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4686</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1324</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.0432</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7829</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2696</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5403</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8980</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9726</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3285</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6865</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2346</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.9037</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6373</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7040</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2287</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0484</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.1706</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5113</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1450</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3574</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4470</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2141</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8799</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9148</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5694</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6186</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="p">[</span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.0431</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5744</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3787</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4686</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1324</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.0432</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7829</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2696</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5403</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8980</span><span class="p">]</span><span class="err">)</span><span class="p">,</span><span class="w"> </span><span class="kc">tens</span><span class="err">or(</span><span class="p">[</span><span class="mf">0.2101</span><span class="p">,</span><span class="w"> </span><span class="mf">0.9726</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3285</span><span class="p">,</span><span class="w"> </span><span class="mf">0.6865</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2346</span><span class="p">]</span><span class="err">)</span><span class="p">]</span>
</code></pre></div>


            <details class="quote">
              <summary>Source code in <code>perceptrain/data.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="k">def</span><span class="w"> </span><span class="nf">to_dataloader</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">infinite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DataLoader</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert torch tensors an (infinite) Dataloader.</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a><span class="sd">    Arguments:</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="sd">        *tensors: Torch tensors to use in the dataloader.</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="sd">        batch_size: batch size of sampled tensors</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a><span class="sd">        infinite: if `True`, the dataloader will keep sampling indefinitely even after the whole</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">            dataset was sampled once</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">    Examples:</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">    ```python exec=&quot;on&quot; source=&quot;above&quot; result=&quot;json&quot;</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">    import torch</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">    from perceptrain import to_dataloader</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">    (x, y, z) = [torch.rand(10) for _ in range(3)]</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">    loader = iter(to_dataloader(x, y, z, batch_size=5, infinite=True))</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="sd">    print(next(loader))</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    ```</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>    <span class="n">ds</span> <span class="o">=</span> <span class="n">InfiniteTensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span> <span class="k">if</span> <span class="n">infinite</span> <span class="k">else</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="o">*</span><span class="n">tensors</span><span class="p">)</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">return</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="perceptrain.models.QNN" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">QNN</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="QuantumModel() (perceptrain.models.QuantumModel)" href="#perceptrain.models.QuantumModel">QuantumModel</a></code></p>


        <p>A specialized quantum neural network that extends QuantumModel.</p>
<p>You can define additional layers, parameters, and logic specific
to your quantum model here.</p>







                  <details class="quote">
                    <summary>Source code in <code>perceptrain/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-37" name="__codelineno-0-37"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="perceptrain.models.QNN.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>The forward pass for the quantum neural network.</p>
<p>Replace with your actual quantum circuit logic if you have a
quantum simulator or hardware integration. This example just
passes x through a classical linear layer.</p>


            <details class="quote">
              <summary>Source code in <code>perceptrain/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-40" name="__codelineno-0-40"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">    The forward pass for the quantum neural network.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">    Replace with your actual quantum circuit logic if you have a</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">    quantum simulator or hardware integration. This example just</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">    passes x through a classical linear layer.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="perceptrain.models.QuantumModel" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">QuantumModel</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="torch.nn.Module">Module</span></code></p>


        <p>Base class for any quantum-based model.</p>
<p>Inherits from nn.Module.
Subclasses should implement a forward method that handles quantum logic.</p>







                  <details class="quote">
                    <summary>Source code in <code>perceptrain/models.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="perceptrain.models.QuantumModel.forward" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Override this method in subclasses to provide.</p>
<p>the forward pass for your quantum model.</p>


            <details class="quote">
              <summary>Source code in <code>perceptrain/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">Tensor</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tensor</span><span class="p">:</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Override this method in subclasses to provide.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    the forward pass for your quantum model.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>    <span class="k">return</span> <span class="n">x</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.tabs", "navigation.indexes", "navigation.sections", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../extras/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>